üöÄ Starting automation...
   URL: https://www.seoily.com/contact-us
   Fields to fill: 0
üìÑ Loading page...
‚úÖ Page loaded
üîß Fixing zoom and positioning...
üîç Checking for overlay banners, cookie consent, and modals...
   ‚ÑπÔ∏è  No overlays found or already closed
üîç Waiting for form fields to load...
   ‚ö†Ô∏è  Form fields not found immediately, continuing...
üîç Discovering forms on page...
‚úÖ Found 2 form(s)
   üìã Selected form with 20 fields (score: 5)
üìù Found 20 fields in target form
ü§ñ Auto-detect mode enabled: Automatically detecting form fields...
   ‚ö†Ô∏è  No fields detected by type matching, using fallback: filling any visible text/textarea fields
   ‚úÖ Auto-detected 0 fields: 
   ‚ö†Ô∏è  Could not auto-detect any fillable fields. Make sure form has name, email, or message fields.
‚ö†Ô∏è  No fields to fill. Skipping form fill.
üîç Checking for overlays that might block CAPTCHA...
‚úÖ Checking consent/terms checkboxes automatically...
   ‚ÑπÔ∏è  No unchecked consent checkboxes found
üîê Checking for CAPTCHA (initial check)...
   CAPTCHA detected: recaptcha
üîç CAPTCHA solving check: use_local=True, captcha_type=recaptcha, site_key=present
ü§ñ Step 1: Trying LOCAL CAPTCHA SOLVER (fully automated)...
   Site key: 6LdwsYQqAAAAANyLuMH-...
   Page URL: https://www.seoily.com/contact-us
   ‚è±Ô∏è  Using timeout: 180s (headless mode)
üñ±Ô∏è  Clicking reCAPTCHA checkbox...
   üîç Looking for reCAPTCHA checkbox...
   ‚è≥ Waiting for reCAPTCHA to load...
   üìã Strategy 1: Looking for reCAPTCHA iframe...
   ‚úÖ Found iframe with selector: iframe[src*="recaptcha"][src*="anchor"]
   üîÑ Accessing iframe content...
   ‚úÖ Iframe content accessible
   ‚úÖ Checkbox element found in iframe
   üñ±Ô∏è  Clicking checkbox...
   ‚è∞ Local solver timeout (180s)
   Hybrid mode disabled - will not try external services
‚ö†Ô∏è  Local solver failed: Local CAPTCHA solver returned empty token
üìã Full error trace:
Traceback (most recent call last):
  File "/var/www/html/TEQSmartSubmit/automation/./run_submission.py", line 1769, in run_submission
    raise RuntimeError("Local CAPTCHA solver returned empty token")
RuntimeError: Local CAPTCHA solver returned empty token

‚ùå Local solver failed and hybrid mode is disabled. Will not try external services.
   ‚ö†Ô∏è  Local solver already failed, skipping external fallback (no API keys)
‚ö†Ô∏è  No CAPTCHA solver available. Please configure API keys or enable manual solving.
Traceback (most recent call last):
  File "test_headless_local.py", line 89, in test_submission
    result = await run_submission(TEST_URL, template_path)
  File "/var/www/html/TEQSmartSubmit/automation/./run_submission.py", line 1911, in run_submission
    raise RuntimeError(error_msg)
RuntimeError: reCAPTCHA detected but all automated solvers failed. Local solver failed (Local CAPTCHA solver returned empty token). No external solver available (no API keys configured). Options: 1) Enable local solver with 'use_local_captcha_solver': true (already enabled), 2) Set CAPTCHA API keys, 3) Use test mode with 'headless': false for manual solving

================================================================================
TEQSmartSubmit Local Headless Mode Test
================================================================================
Server: teqtop-OptiPlex-3050
Python: 3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
Working Directory: /var/www/html/TEQSmartSubmit/automation
================================================================================

================================================================================
Local Headless Mode Test - Environment Check
================================================================================
DISPLAY environment variable: NOT SET (simulating remote server)
Has display: False
TEQ_FORCE_HEADLESS: true
HEADLESS: NOT SET

Expected browser mode: HEADLESS MODE (forced)
================================================================================

================================================================================
Testing Form Submission in Headless Mode
================================================================================
URL: https://www.seoily.com/contact-us
Template headless: True
================================================================================

üöÄ Starting automation in HEADLESS mode...

================================================================================

‚ùå EXCEPTION: reCAPTCHA detected but all automated solvers failed. Local solver failed (Local CAPTCHA solver returned empty token). No external solver available (no API keys configured). Options: 1) Enable local solver with 'use_local_captcha_solver': true (already enabled), 2) Set CAPTCHA API keys, 3) Use test mode with 'headless': false for manual solving

Troubleshooting:
1. Ensure Playwright is installed: pip install playwright && playwright install chromium
2. Check Python dependencies
3. Verify network connectivity to the target URL

================================================================================
Test Complete
================================================================================
