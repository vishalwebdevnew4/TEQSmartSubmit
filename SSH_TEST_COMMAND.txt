# Copy and paste this command to test on your server:

ssh -p 3129 teqsmartsftpuser@teqsmartsubmit.xcelanceweb.com "cd ~ && bash -c 'SCRIPT_FILE=\$(find ~ /var/www -name \"form_discovery.py\" -path \"*/automation/submission/*\" 2>/dev/null | head -1); if [ -z \"\$SCRIPT_FILE\" ]; then echo \"‚ùå File not found - run: git pull\"; exit 1; fi; echo \"‚úÖ Found: \$SCRIPT_FILE\"; echo \"\"; echo \"Testing fix...\"; FIXES=0; grep -q \"def safe_write\" \"\$SCRIPT_FILE\" && echo \"‚úÖ safe_write\" && FIXES=\$((FIXES+1)) || echo \"‚ùå safe_write missing\"; grep -q \"Only flush if it's a TTY\" \"\$SCRIPT_FILE\" && echo \"‚úÖ TTY check\" && FIXES=\$((FIXES+1)) || echo \"‚ùå TTY check missing\"; grep -q \"safe_write.*Function called\" \"\$SCRIPT_FILE\" && echo \"‚úÖ safe_write used\" && FIXES=\$((FIXES+1)) || echo \"‚ùå not used\"; echo \"Result: \$FIXES/3\"; python3 -m py_compile \"\$SCRIPT_FILE\" 2>&1 && echo \"‚úÖ Syntax OK\" || echo \"‚ùå Syntax error\"; SCRIPT_DIR=\$(dirname \"\$(dirname \"\$(dirname \"\$SCRIPT_FILE\")\")\"); cd \"\$SCRIPT_DIR\" 2>/dev/null; timeout 15 python3 -c \"import sys,os; sys.path.insert(0,os.getcwd()); from automation.submission import form_discovery; print('‚úÖ Import OK')\" 2>&1 && echo \"‚úÖ Import OK\" || echo \"‚ö†Ô∏è Import issue\"; if [ \$FIXES -eq 3 ]; then echo \"üéâ ALL TESTS PASSED!\"; else echo \"‚ö†Ô∏è Some tests failed\"; fi'"

# OR simpler - just run the test script if it exists:

ssh -p 3129 teqsmartsftpuser@teqsmartsubmit.xcelanceweb.com "cd ~ && [ -f test_fix_on_server.sh ] && bash test_fix_on_server.sh || (find . -name 'test_fix_on_server.sh' -exec bash {} \;)"

